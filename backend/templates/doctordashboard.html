<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/doctor_dashboard.css') }}">
</head>
<body>
    <div class="floating-elements">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>
    
    <div class="dashboard-container">
        <header class="dashboard-header">
            <div class="header-content">
                <div class="doctor-info">
                    <div class="doctor-avatar">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 
                                1.79-4 4 1.79 4 4 4zm0 2c-2.67 
                                0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                    </div>
                    <div class="doctor-details">
                        <h1 class="doctor-name">Welcome, Dr. {{ doctor.name }}</h1>
                        <p class="specialization">{{ doctor.specialization }}</p>
                        <div class="status-badge">
                            <span class="status-indicator"></span>
                            Available
                        </div>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 
                                    16.59 3.41 18l6-6 4 4 
                                    6.3-6.29L22 12V6z"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <span class="stat-number">{{ patients|length if patients else 0 }}</span>
                            <span class="stat-label">Today's Patients</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <section class="patient-list-section">
            <div class="section-header">
                <h2 class="section-title">
                    <svg class="title-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 3H5c-1.1 0-2 .9-2 
                            2v14c0 1.1.9 2 2 
                            2h14c1.1 0 2-.9 
                            2-2V5c0-1.1-.9-2-2-2zm-5 
                            14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                    </svg>
                    Booked Patients
                </h2>
                <div class="search-filter">
                    <div class="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.5 14h-.79l-.28-.27C15.41 
                                12.59 16 11.11 16 9.5 16 
                                5.91 13.09 3 9.5 3S3 5.91 
                                3 9.5 5.91 16 9.5 16c1.61 
                                0 3.09-.59 
                                4.23-1.57l.27.28v.79l5 
                                4.99L20.49 19l-4.99-5zm-6 
                                0C7.01 14 5 11.99 5 
                                9.5S7.01 5 9.5 5 14 
                                7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                        <input type="text" placeholder="Search patients..." id="patientSearch">
                    </div>
                </div>
            </div>

            {% if patients %}
                <div class="table-container">
                    <table class="patients-table">
                        <thead>
                            <tr>
                                <th>Patient Name</th>
                                <th>Age</th>
                                <th>Contact</th>
                                <th>Last Seen</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for patient in patients %}
                            <tr class="patient-row">
                                <td class="patient-name-cell">
                                    <div class="patient-name-content">
                                        {% if patient.patient_name %}
                                            <div class="patient-initial">{{ patient.patient_name[0].upper() }}</div>
                                        {% else %}
                                            <div class="patient-initial">?</div>
                                        {% endif %}
                                        <span class="patient-name">{{ patient.patient_name }}</span>
                                    </div>
                                </td>
                                <td class="patient-age">
                                    <span class="age-badge">{{ patient.patient_age }} yrs</span>
                                </td>
                                <td class="patient-contact">
                                    <div class="contact-info">
                                        <svg class="contact-icon" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M6.62,10.79C8.06,13.62 
                                                10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 
                                                16.08,14.82 16.43,14.93C17.55,15.3 
                                                18.75,15.5 20,15.5A1,1 0 0,1 
                                                21,16.5V20A1,1 0 0,1 
                                                20,21A17,17 0 0,1 
                                                3,4A1,1 0 0,1 
                                                4,3H7.5A1,1 0 0,1 
                                                8.5,4C8.5,5.25 8.7,6.45 
                                                9.07,7.57C9.18,7.92 
                                                9.1,8.31 8.82,8.59L6.62,10.79Z"/>
                                        </svg>
                                        <span>{{ patient.patient_phone }}</span>
                                    </div>
                                </td>
                                <td class="appointment-date">
                                    <div class="date-badge">
                                        <svg class="date-icon" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 
                                                3,3.89 3,5V19A2,2 0 0,0 
                                                5,21H19A2,2 0 0,0 
                                                21,19V5C21,3.89 20.1,3 
                                                19,3H18V1M17,12H12V17H17V12Z"/>
                                        </svg>
                                        <span>{{ patient.last_message_time }}</span>
                                    </div>
                                </td>
                                <td class="action-cell">
                                    <a href="{{ url_for('chat_with_patient', doctor_id=doctor.id, patient_id=patient.patient_id) }}">
                                        <button class="chat-btn">
                                            <svg class="chat-icon" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M12,3C17.5,3 22,6.58 22,11C22,15.42 
                                                    17.5,19 12,19C10.76,19 
                                                    9.57,18.82 8.47,18.5C5.55,21 
                                                    2,21 2,21C4.33,18.67 
                                                    4.7,17.1 4.75,16.5C3.05,15.07 
                                                    2,13.13 2,11C2,6.58 
                                                    6.5,3 12,3Z"/>
                                            </svg>
                                            <span>Chat</span>
                                        </button>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,2A10,10 0 0,0 2,12A10,10 
                                0 0,0 12,22A10,10 0 0,0 
                                22,12A10,10 0 0,0 12,2M12,17A5,5 
                                0 0,1 7,12A5,5 0 0,1 
                                12,7A5,5 0 0,1 
                                17,12A5,5 0 0,1 
                                12,17M12,9A3,3 0 0,0 
                                9,12A3,3 0 0,0 
                                12,15A3,3 0 0,0 
                                15,12A3,3 0 0,0 12,9Z"/>
                        </svg>
                    </div>
                    <h3 class="empty-title">No Appointments Yet</h3>
                    <p class="empty-message">Your patient appointments will appear here once they start booking consultations with you.</p>
                    <div class="empty-actions">
                        <button class="refresh-btn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17.65,6.35C16.2,4.9 
                                    14.21,4 12,4A8,8 0 0,0 
                                    4,12A8,8 0 0,0 
                                    12,20C15.73,20 18.84,17.45 
                                    19.73,14H17.65C16.83,16.33 
                                    14.61,18 12,18A6,6 0 0,1 
                                    6,12A6,6 0 0,1 
                                    12,6C13.66,6 15.14,6.69 
                                    16.22,7.78L13,11H20V4L17.65,6.35Z"/>
                            </svg>
                            Refresh
                        </button>
                    </div>
                </div>
            {% endif %}
        </section>
    </div>

    <script>
        // Search functionality
        document.getElementById('patientSearch')?.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('.patient-row');
            
            rows.forEach(row => {
                const patientName = row.querySelector('.patient-name').textContent.toLowerCase();
                const isMatch = patientName.includes(searchTerm);
                row.style.display = isMatch ? '' : 'none';
                
                if (isMatch && searchTerm) {
                    row.style.animation = 'highlightRow 0.5s ease';
                } else {
                    row.style.animation = '';
                }
            });
        });

        // Add hover effects and animations
        document.querySelectorAll('.patient-row').forEach(row => {
            row.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.01)';
            });
            
            row.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        });

        // Refresh functionality
        document.querySelector('.refresh-btn')?.addEventListener('click', function() {
            location.reload();
        });
    </script>
</body>
</html>